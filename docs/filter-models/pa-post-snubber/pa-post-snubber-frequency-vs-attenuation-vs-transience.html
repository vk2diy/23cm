<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D Plot with Noise Zones using Plotly.js</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { margin: 0; }
        #plot { width: 70vw; height: 80vh; float: left; }
        #legend { width: 25vw; height: 80vh; float: right; padding: 20px; }
    </style>
</head>
<body>
    <div id="plot"></div>
    <div id="legend">
        <h2>Noise Types Legend</h2>
        <ul id="legend-list"></ul>
    </div>
    <script>
        // Define data points
        const frequencies = [
            500, 1000, 2000, 3000, 4000, 5000, 6000, 7000, 8000, 9000, 10000,
            12000, 14000, 16000, 18000, 20000, 22000, 24000, 26000, 28000, 30000,
            32000, 34000, 36000, 38000, 40000
        ];
        const transiences = [
            0.2, 0.3, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8,
            0.85, 0.9, 0.95, 1.0, 1.05, 1.1, 1.15, 1.2, 1.25, 1.3,
            1.35, 1.4, 1.45, 1.5, 1.55
        ];
        const attenuations = [
            -30, -25, -20, -18, -15, -12, -10, -8, -5, -3, -2,
            0, 2, 4, 6, 8, 10, 12, 14, 16, 18,
            20, 22, 24, 26, 28
        ];

        // Define noise zones
        const noiseZones = {
            'Thermal Noise': {
                frequencyRange: [1000, 3000],
                transienceRange: [0.4, 0.6],
                color: 'rgba(0, 0, 255, 1)' // 100% opacity
            },
            'Shot Noise': {
                frequencyRange: [2000, 6000],
                transienceRange: [0.6, 0.8],
                color: 'rgba(0, 255, 0, 1)' // 100% opacity
            },
            'Flicker Noise': {
                frequencyRange: [5000, 15000],
                transienceRange: [0.8, 1.0],
                color: 'rgba(255, 165, 0, 1)' // 100% opacity
            },
            'Power Line Noise': {
                frequencyRange: [50, 100],
                transienceRange: [0.3, 0.7],
                color: 'rgba(255, 0, 0, 1)' // 100% opacity
            },
            'RF Interference': {
                frequencyRange: [8000, 12000],
                transienceRange: [0.5, 0.9],
                color: 'rgba(128, 0, 128, 1)' // 100% opacity
            },
            'Digital Noise': {
                frequencyRange: [20000, 50000],
                transienceRange: [0.7, 1.2],
                color: 'rgba(0, 255, 255, 1)' // 100% opacity
            }
        };

        // Define the 3D plot data
        const data = [{
            x: frequencies,
            y: transiences,
            z: attenuations,
            mode: 'markers',
            type: 'scatter3d',
            marker: {
                size: 4,
                color: attenuations,
                colorscale: [
                    [0, 'red'],
                    [0.5, 'white'],
                    [1, 'blue']
                ],
                colorbar: {
                    title: 'Attenuation (dB)'
                }
            }
        }];

        // Add noise zones as 2D planes at 0 dB
        for (const [label, { frequencyRange, transienceRange, color }] of Object.entries(noiseZones)) {
            data.push({
                x: [frequencyRange[0], frequencyRange[1], frequencyRange[1], frequencyRange[0], frequencyRange[0]],
                y: [transienceRange[0], transienceRange[0], transienceRange[1], transienceRange[1], transienceRange[0]],
                z: [0, 0, 0, 0, 0],
                fill: 'toself',
                fillcolor: color,
                line: { color: color, width: 1 },
                mode: 'lines',
                type: 'scatter3d'
            });

            // Add noise zones to legend
            document.getElementById('legend-list').innerHTML += `
                <li style="color: ${color};">${label}</li>
            `;
        }

        // Define layout
        const layout = {
            scene: {
                xaxis: { title: 'Frequency (Hz)' },
                yaxis: { title: 'Transience (s)' },
                zaxis: { title: 'Attenuation (dB)' }
            },
            title: '3D Plot with Noise Zones'
        };

        // Create the plot
        Plotly.newPlot('plot', data, layout);
    </script>
</body>
</html>
